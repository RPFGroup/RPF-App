# 🖨️ دليل الطباعة الاحترافية للتقارير

## ✨ المميزات الجديدة

تم تحسين نظام الطباعة بشكل كامل ليناسب **الوثائق الرسمية والمهمة**:

### 1. **رأس صفحة احترافي** 📄
```
✅ شعار الشركة (RABAT Engineering)
✅ معلومات الشركة والموقع
✅ نوع التقرير
✅ تاريخ ووقت إصدار التقرير
✅ رمز المشروع (إن وجد)
✅ اسم المشروع (إن وجد)
✅ معد التقرير
```

### 2. **تذييل صفحة احترافي** 📝
```
✅ حقوق النشر (Copyright)
✅ تاريخ ووقت الإصدار
✅ ترقيم الصفحات تلقائي
```

### 3. **قسم التوقيعات** ✍️
```
✅ Prepared By (معد التقرير)
✅ Reviewed By (مراجع التقرير)
✅ Approved By (معتمد التقرير)
✅ مساحات للتوقيع
✅ خانات للتاريخ
```

### 4. **تنسيق احترافي** 🎨
```
✅ خطوط واضحة ومقروءة
✅ جداول منسقة بشكل جميل
✅ ألوان مناسبة للطباعة
✅ فواصل صفحات ذكية
✅ تجنب تقسيم الجداول
```

---

## 🎯 كيفية الطباعة

### الطريقة 1: زر الطباعة في الصفحة

```
1. افتح /reports
2. اختر نوع التقرير المطلوب
3. طبق الفلاتر إذا لزم الأمر
4. اضغط زر "Print Report" 🖨️
5. سيفتح نافذة الطباعة
```

### الطريقة 2: اختصار لوحة المفاتيح

```
1. افتح التقرير المطلوب
2. اضغط Ctrl + P (Windows) أو Cmd + P (Mac)
3. سيفتح نافذة الطباعة مباشرة
```

---

## 📋 إعدادات الطباعة الموصى بها

### في نافذة الطباعة (Print Dialog):

#### 1. Page Setup (إعداد الصفحة)
```
✅ Paper Size: A4
✅ Orientation: Portrait (عمودي)
✅ Margins: Default (أو Custom: 2cm top/bottom, 1.5cm left/right)
✅ Scale: 100%
```

#### 2. Options (الخيارات)
```
✅ Print Background Graphics: ON (مهم للألوان!)
✅ Print Headers and Footers: ON
✅ Two-sided: OFF (أو ON حسب الحاجة)
```

#### 3. Color (اللون)
```
✅ Color: Colored (للطباعة الملونة)
أو
✅ Black & White (للتوفير)
```

---

## 🎨 ما يظهر عند الطباعة

### يظهر (Visible):
✅ **رأس الصفحة:**
   - شعار الشركة
   - معلومات الشركة
   - عنوان التقرير
   - معلومات الوثيقة (نوع، تاريخ، معد التقرير)

✅ **المحتوى الرئيسي:**
   - الإحصائيات والأرقام
   - الجداول المنسقة
   - الرسوم البيانية (Progress Bars)
   - البيانات التفصيلية

✅ **التذييل:**
   - حقوق النشر
   - تاريخ ووقت الإصدار
   - رقم الصفحة

✅ **التوقيعات:**
   - مساحات للتوقيعات الثلاثة
   - خانات للتاريخ
   - الأسماء والمسميات الوظيفية

### لا يظهر (Hidden):
❌ أزرار (Refresh, Print, Export)
❌ Filters و Dropdowns
❌ الـ Navigation (Sidebar)
❌ العناصر التفاعلية
❌ Dark mode elements

---

## 📊 تنسيق العناصر

### 1. الجداول (Tables)

**المواصفات:**
```
- عرض كامل للصفحة
- رأس جدول ملون (أزرق غامق)
- صفوف متناوبة الألوان (أبيض/رمادي فاتح)
- خطوط واضحة بين الخلايا
- خط 9pt مقروء
- تجنب التقسيم في منتصف الصف
```

**مثال:**
```
┌────────────────────────────────────────┐
│ Activity  │ Project │ Planned │ Actual │
├────────────────────────────────────────┤
│ Activity1 │ P6060   │ 100     │ 85     │ (صف أبيض)
│ Activity2 │ P5074   │ 50      │ 50     │ (صف رمادي)
│ Activity3 │ P5082   │ 200     │ 180    │ (صف أبيض)
└────────────────────────────────────────┘
```

### 2. بطاقات الإحصائيات (Stat Cards)

**المواصفات:**
```
- إطار ملون
- خلفية فاتحة
- رقم كبير وواضح
- نص توضيحي صغير
- لا تنقسم على صفحتين
```

**مثال:**
```
┌──────────────────────┐
│ Total Projects       │
│      326             │ (رقم كبير)
│ 245 active          │ (تفاصيل صغيرة)
└──────────────────────┘
```

### 3. Progress Bars (أشرطة التقدم)

**المواصفات:**
```
- لون أزرق ثابت
- نسبة مئوية واضحة
- خلفية رمادية فاتحة
- عرض مناسب
```

**مثال:**
```
[████████████░░░░░░░░] 65%
```

### 4. Status Badges (شارات الحالة)

**المواصفات:**
```
- ألوان مناسبة للطباعة:
  • Completed: أخضر فاتح + نص أخضر غامق
  • In Progress: أزرق فاتح + نص أزرق غامق
  • Delayed: أحمر فاتح + نص أحمر غامق
  • On Hold: أصفر فاتح + نص أصفر غامق
- إطار ملون
- خط صغير وواضح
```

---

## 📄 أنواع التقارير القابلة للطباعة

### 1. Summary Report (تقرير ملخص)
**يحتوي على:**
- إحصائيات شاملة
- تفصيل العمل حسب الفترات
- نظرة عامة على المشاريع والأنشطة
- نسبة التقدم الإجمالية

**مناسب لـ:** الاجتماعات الإدارية، العروض التقديمية

---

### 2. Daily Report (تقرير يومي)
**يحتوي على:**
- أنشطة اليوم الحالي
- المخطط vs الفعلي
- حالة كل نشاط
- جدول تفصيلي

**مناسب لـ:** التقارير اليومية، Site Diary

---

### 3. Weekly Report (تقرير أسبوعي)
**يحتوي على:**
- أنشطة الأسبوع الحالي
- إحصائيات الإنجاز
- الأنشطة المكتملة والمتأخرة
- جدول شامل

**مناسب لـ:** الاجتماعات الأسبوعية، Progress Reports

---

### 4. Monthly Report (تقرير شهري)
**يحتوي على:**
- أنشطة الشهر الحالي
- التقدم الشهري الكامل
- تحليل الأداء
- جداول تفصيلية

**مناسب لـ:** التقارير الإدارية، Monthly Reviews، Invoicing

---

### 5. Lookahead Report (تقرير استشرافي)
**يحتوي على:**
- الأسبوع الحالي (Current Week)
- الأسبوع القادم (Next Week)
- المسار الحرج (Critical Path)
- الأنشطة القادمة

**مناسب لـ:** التخطيط، Resource Allocation، Risk Management

---

### 6. Projects Report (تقرير المشاريع)
**يحتوي على:**
- قائمة جميع المشاريع
- الأقسام المسؤولة
- الحالات والتقدم
- القيم التعاقدية

**مناسب لـ:** Portfolio Management، Executive Reports

---

### 7. Activities Report (تقرير الأنشطة)
**يحتوي على:**
- جميع أنشطة BOQ
- الكميات المخططة والفعلية
- نسب الإنجاز
- الحالات

**مناسب لـ:** BOQ Tracking، Quantity Surveying

---

### 8. KPIs Report (تقرير المؤشرات)
**يحتوي على:**
- سجلات KPI (Planned & Actual)
- التواريخ
- الكميات
- التصنيف حسب النوع

**مناسب لـ:** Performance Tracking، KPI Analysis

---

### 9. Financial Report (التقرير المالي)
**يحتوي على:**
- القيم التعاقدية الإجمالية
- القيم المكتملة
- القيم المتبقية
- تفصيل لكل مشروع

**مناسب لـ:** Financial Planning، Budget Reports، Invoicing

---

### 10. Performance Report (تقرير الأداء)
**يحتوي على:**
- ترتيب المشاريع حسب الأداء
- أفضل 5 مشاريع
- أسوأ 5 مشاريع (تحتاج انتباه)
- جدول شامل بالترتيب

**مناسب لـ:** Performance Review، Project Ranking

---

## 🎨 التصميم الاحترافي

### الألوان المستخدمة:

#### في الطباعة الملونة:
```
- الأزرق (#1e40af): للعناوين والإطارات
- الأخضر (#10b981): للإنجاز والنجاح
- الأحمر (#ef4444): للتأخير والتحذير
- البرتقالي (#f59e0b): للانتظار
- الرمادي (#6b7280): للنصوص الثانوية
```

#### في الطباعة الأبيض والأسود:
```
- جميع الألوان تتحول إلى Grayscale
- التباين واضح
- قابلة للقراءة تماماً
```

### الخطوط:
```
- العناوين: 14-24pt Bold
- المحتوى: 10pt Regular
- الجداول: 9pt
- التذييل: 8pt
- الملاحظات: 8pt
```

---

## 📏 تخطيط الصفحة

### الهوامش (Margins):
```
Top:    2cm
Bottom: 2cm
Left:   1.5cm
Right:  1.5cm
```

### فواصل الصفحات:
```
✅ تلقائي قبل كل قسم رئيسي
✅ تجنب التقسيم داخل:
   - الجداول
   - بطاقات الإحصائيات
   - قسم التوقيعات
✅ الجداول الطويلة: ترويسة تتكرر في كل صفحة
```

---

## 🔧 الملفات المضافة

### 1. `app/print-reports.css`
**الأنماط الخاصة بالطباعة:**
- @media print rules
- تنسيق الصفحات
- إخفاء العناصر غير الضرورية
- تنسيق الجداول والبطاقات
- ألوان مناسبة للطباعة

### 2. `components/reports/PrintableReport.tsx`
**المكون الرئيسي للطباعة:**
- رأس الصفحة الاحترافي
- معلومات الوثيقة
- قسم التوقيعات
- التذييل
- إشعار السرية (اختياري)

### 3. `components/reports/ModernReportsManager.tsx` (محدّث)
**التكامل مع نظام الطباعة:**
- دمج PrintableReport
- إخفاء العناصر غير الضرورية عند الطباعة
- تحسين التنسيق

---

## 📖 مثال على التقرير المطبوع

### الصفحة الأولى:

```
╔══════════════════════════════════════════════════════════╗
║  RABAT Engineering             [LOGO]                    ║
║  Project Management & Construction Services              ║
║  Dubai, United Arab Emirates                             ║
╠══════════════════════════════════════════════════════════╣
║                                                           ║
║  Document Properties:                                     ║
║  • Document Type:    DAILY REPORT                        ║
║  • Report Date:      October 8, 2025                     ║
║  • Project Code:     P6060                               ║
║  • Project Name:     ABHUDHABI                           ║
║  • Prepared By:      System Administrator                ║
║  • Generated:        02:30 PM                            ║
║  • Period:           October 8, 2025                     ║
║                                                           ║
╠══════════════════════════════════════════════════════════╣
║                                                           ║
║            Daily Progress Report                          ║
║            October 8, 2025                                ║
║                                                           ║
╚══════════════════════════════════════════════════════════╝

[إحصائيات - 4 بطاقات ملونة]

┌─────────────────┬─────────────────┬─────────────────┐
│ Total Planned   │ Total Actual    │ Progress        │
│     150         │     120         │     80%         │
└─────────────────┴─────────────────┴─────────────────┘

[جدول الأنشطة التفصيلي]

┌──────────────────────────────────────────────────────────┐
│ Activity    │ Project │ Planned │ Actual │ Progress │    │
├──────────────────────────────────────────────────────────┤
│ C.Piles     │ P6060   │ 20      │ 20     │ 100%     │ ✓  │
│ Excavation  │ P5074   │ 50      │ 45     │ 90%      │ ⟳  │
└──────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════

Page 1 of 2
```

### الصفحة الأخيرة:

```
════════════════════════════════════════════════════════════

Approvals & Signatures

┌─────────────────┬─────────────────┬─────────────────┐
│ Prepared By     │ Reviewed By     │ Approved By     │
├─────────────────┼─────────────────┼─────────────────┤
│                 │                 │                 │
│ ____________    │ ____________    │ ____________    │
│                 │                 │                 │
│ Eng. Ahmed Ali  │ ____________    │ ____________    │
│ Engineer        │ Project Manager │ Project Director│
│                 │                 │                 │
│ Date: ______    │ Date: ______    │ Date: ______    │
└─────────────────┴─────────────────┴─────────────────┘

────────────────────────────────────────────────────────────
© 2025 RABAT Engineering - All Rights Reserved
Generated: October 8, 2025 at 02:30 PM            Page 2 of 2
════════════════════════════════════════════════════════════
```

---

## 🎯 أمثلة الاستخدام

### مثال 1: تقرير يومي للموقع

```
1. افتح /reports
2. اختر "Daily" Report
3. سيعرض أنشطة اليوم تلقائياً
4. اضغط Print
5. طباعة → أرشفة أو توقيع
```

**الاستخدام:**
- التقرير اليومي للموقع
- Site Diary
- Daily Briefing

---

### مثال 2: تقرير شهري للإدارة

```
1. افتح /reports
2. اختر "Monthly" Report
3. راجع البيانات
4. اضغط Print
5. طباعة → توقيع → إرسال للإدارة
```

**الاستخدام:**
- التقرير الشهري للإدارة
- Monthly Management Report
- Progress Report to Client

---

### مثال 3: تقرير مشروع محدد

```
1. افتح /reports
2. استخدم Smart Filter
3. اختر المشروع المطلوب (مثل P6060)
4. اضغط Refresh
5. اختر نوع التقرير المطلوب
6. اضغط Print
7. سيتضمن رمز واسم المشروع في الرأس
```

**الاستخدام:**
- تقارير خاصة بمشروع معين
- Project-specific Reports
- Client Reports

---

### مثال 4: تقرير أداء للعرض

```
1. افتح /reports
2. اختر "Performance" Report
3. سيرتب المشاريع حسب الأداء
4. اضغط Print
5. استخدم في الاجتماعات
```

**الاستخدام:**
- اجتماعات المراجعة
- Performance Reviews
- Project Rankings

---

## 💡 نصائح للطباعة الأفضل

### 1. للتقارير الرسمية:
```
✅ استخدم طباعة ملونة
✅ ورق A4 عالي الجودة
✅ طباعة وجه واحد
✅ تأكد من "Print Background Graphics" مفعّل
```

### 2. للنسخ الداخلية:
```
✅ طباعة أبيض وأسود (توفير)
✅ طباعة على الوجهين
✅ ورق عادي
```

### 3. للأرشفة:
```
✅ طباعة ملونة
✅ ورق عالي الجودة
✅ حفظ في ملف PDF أيضاً (Print → Save as PDF)
```

### 4. للعروض التقديمية:
```
✅ طباعة ملونة
✅ ورق Presentation Paper
✅ تجليد احترافي
```

---

## 📱 الطباعة إلى PDF

### الطريقة:

```
1. اضغط Print (أو Ctrl+P)
2. في نافذة الطباعة:
   - Destination: اختر "Save as PDF"
3. اضغط Save
4. اختر المكان واحفظ
```

**الفائدة:**
- حفظ نسخة إلكترونية
- سهولة المشاركة عبر Email
- أرشفة رقمية
- لا تستهلك حبر الطابعة

---

## ✅ Checklist قبل الطباعة

### قبل الضغط على Print:

- [ ] التقرير الصحيح محدد؟
- [ ] الفلاتر مطبقة بشكل صحيح؟
- [ ] البيانات محدثة (Refresh)؟
- [ ] راجعت المحتوى؟
- [ ] الإحصائيات صحيحة؟

### في نافذة الطباعة:

- [ ] Paper Size: A4
- [ ] Orientation: Portrait
- [ ] Print Background Graphics: ON
- [ ] Scale: 100%
- [ ] Color: Colored (أو B&W)

### بعد الطباعة:

- [ ] راجع الصفحات المطبوعة
- [ ] تأكد من وضوح النص
- [ ] تأكد من ظهور الألوان
- [ ] وقّع في خانات التوقيع

---

## 🎉 المميزات الاحترافية

### 1. **مظهر رسمي** ✅
- رأس وتذييل احترافي
- شعار الشركة
- معلومات كاملة

### 2. **سهولة القراءة** ✅
- خطوط واضحة
- أحجام مناسبة
- تباين جيد

### 3. **التنظيم** ✅
- فواصل صفحات ذكية
- لا تنقسم الجداول
- تدفق منطقي

### 4. **التوقيعات** ✅
- مساحات واضحة
- ثلاثة مستويات
- خانات للتاريخ

### 5. **المرونة** ✅
- يناسب جميع أنواع التقارير
- قابل للتخصيص
- يدعم الفلاتر

---

## 📊 الخلاصة

نظام الطباعة الآن:
- ✅ **احترافي** - مناسب للوثائق الرسمية
- ✅ **شامل** - يدعم جميع أنواع التقارير (10 أنواع)
- ✅ **منظم** - رأس وتذييل وتوقيعات
- ✅ **واضح** - خطوط وألوان مناسبة
- ✅ **مرن** - طباعة ملونة أو أبيض وأسود
- ✅ **ذكي** - فواصل صفحات تلقائية
- ✅ **متكامل** - مع نظام التقارير الكامل

---

## 🚀 جرّب الآن!

```bash
1. افتح /reports
2. اختر أي تقرير
3. اضغط Ctrl + P
4. راجع المعاينة
5. لاحظ:
   ✅ رأس احترافي
   ✅ جداول منسقة
   ✅ توقيعات في النهاية
   ✅ تذييل في كل صفحة
```

---

**نظام الطباعة الآن جاهز للاستخدام الرسمي! 🎉**

---

## 📞 ملاحظات إضافية

### للتخصيص:
يمكنك تعديل:
- اسم الشركة في `PrintableReport.tsx`
- الألوان في `print-reports.css`
- معلومات التذييل
- أسماء الموقعين

### للمستقبل:
يمكن إضافة:
- شعار حقيقي للشركة (صورة)
- باركود أو QR code
- Watermark (علامة مائية)
- Header/Footer مخصص لكل تقرير
- Digital signatures support

---

**جاهز للاستخدام في الوثائق الرسمية! ✅**

