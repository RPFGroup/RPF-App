# ๐ ุฏููู ุฅุฏุงุฑุฉ ุฃููุงุน ุงููุดุงุฑูุน (Project Types Management)

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ูุธุงู ุดุงูู ูุฅุฏุงุฑุฉ ุฃููุงุน ุงููุดุงุฑูุน (Project Types) ูู Supabase ูุน ุฅููุงููุฉ ุงูุฅุถุงูุฉ ูุงูุชุนุฏููุ ุชูุงูุงู ูุซู ูุธุงู ุงูุฃูุณุงู.

## โจ ุงููุฒุงูุง ุงูุฌุฏูุฏุฉ

### 1. **ุฃููุงุน ุงููุดุงุฑูุน ุงูุงูุชุฑุงุถูุฉ (10 ุฃููุงุน)**
- Infrastructure (INF)
- Building Construction (BLD)
- Road Construction (RD)
- Marine Works (MAR)
- Landscaping (LND)
- Maintenance (MNT)
- Enabling Division (ENA)
- Soil Improvement Division (SID)
- Infrastructure Division (IDV)
- Marine Division (MDV)

### 2. **ุฅุฏุงุฑุฉ ูุงููุฉ ูุฃููุงุน ุงููุดุงุฑูุน**
- โ ุฅุถุงูุฉ ุฃููุงุน ุฌุฏูุฏุฉ
- โ ุชุนุฏูู ุงูุฃููุงุน ุงูููุฌูุฏุฉ
- โ ุญุฐู (ุชุนุทูู) ุงูุฃููุงุน
- โ ุงูุจุญุซ ูุงูููุชุฑุฉ
- โ ุชุชุจุน ุนุฏุฏ ุงูุงุณุชุฎุฏุงูุงุช

### 3. **ุงูุชูุงูู ูุน ุงูููุงุฐุฌ**
- ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ูู Smart Project Creator
- ุฅููุงููุฉ ุฅุถุงูุฉ ููุน ุฌุฏูุฏ ูุจุงุดุฑุฉ ูู ุงููููุฐุฌ
- ุชุญุฏูุซ ุชููุงุฆู ูููุงุฆูุฉ ุนูุฏ ุฅุถุงูุฉ ููุน ุฌุฏูุฏ

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### ุงููููุงุช ุงูุฌุฏูุฏุฉ

1. **`lib/projectTypesManager.ts`**
   - ุฅุฏุงุฑุฉ ุงูุนูููุงุช ูุน Supabase
   - ุฏูุงู ููุฅุถุงูุฉุ ุงูุชุนุฏููุ ุงูุญุฐูุ ูุงูุจุญุซ
   - ุชุชุจุน ุนุฏุฏ ุงุณุชุฎุฏุงู ูู ููุน

2. **`components/settings/ProjectTypesManager.tsx`**
   - ูุงุฌูุฉ ูุณุชุฎุฏู ูุฅุฏุงุฑุฉ ุฃููุงุน ุงููุดุงุฑูุน
   - ูููุฐุฌ ุฅุถุงูุฉ/ุชุนุฏูู ุงูุฃููุงุน
   - ุนุฑุถ ุงูุฃููุงุน ูู ุดูู ุจุทุงูุงุช

3. **`Database/project-types-table-schema.sql`**
   - SQL Schema ูุฌุฏูู ุฃููุงุน ุงููุดุงุฑูุน
   - Row Level Security (RLS)
   - Triggers ููุชุญุฏูุซ ุงูุชููุงุฆู

### ุงูุชุญุฏูุซุงุช ุนูู ุงููููุงุช ุงูููุฌูุฏุฉ

1. **`components/projects/IntelligentProjectForm.tsx`**
   - ุชุญููู ุฃููุงุน ุงููุดุงุฑูุน ูู Supabase
   - ุฅููุงููุฉ ุฅุถุงูุฉ ููุน ุฌุฏูุฏ ูู ุงููููุฐุฌ
   - ุฒูุงุฏุฉ ุนุฏุงุฏ ุงูุงุณุชุฎุฏุงู ุนูุฏ ุงุฎุชูุงุฑ ููุน

2. **`components/settings/SettingsPage.tsx`**
   - ุฅุถุงูุฉ ุชุงุจ "Project Types" ูููุณุคูููู ูุงููุฏุฑุงุก
   - ุนุฑุถ ูููู ProjectTypesManager

## ๐ ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู `project_types`

```sql
CREATE TABLE project_types (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL UNIQUE,
  code VARCHAR(10),
  description TEXT,
  is_active BOOLEAN DEFAULT TRUE,
  usage_count INTEGER DEFAULT 0,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### ุงูุฃุนูุฏุฉ

- **id**: ุงููุนุฑู ุงููุฑูุฏ (UUID)
- **name**: ุงุณู ููุน ุงููุดุฑูุน (ูุทููุจ ููุฑูุฏ)
- **code**: ุฑูุฒ ุงูููุน (ุงุฎุชูุงุฑูุ ูุซู: INF, BLD)
- **description**: ูุตู ุงูููุน (ุงุฎุชูุงุฑู)
- **is_active**: ูู ุงูููุน ูุดุทุ (ููุญุฐู ุงูุขูู)
- **usage_count**: ุนุฏุฏ ุงููุดุงุฑูุน ุงูุชู ุชุณุชุฎุฏู ูุฐุง ุงูููุน
- **created_at**: ุชุงุฑูุฎ ุงูุฅูุดุงุก
- **updated_at**: ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ

## ๐ ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ

### 1. ุฅูุดุงุก ุฌุฏูู ุฃููุงุน ุงููุดุงุฑูุน ูู Supabase

ูู ุจุชุดุบูู SQL Script ูู Supabase SQL Editor:

```bash
# ุงูุชุญ Supabase Dashboard
# ุงูุชูู ุฅูู SQL Editor
# ููุฐ ูุญุชูู ููู: Database/project-types-table-schema.sql
```

### 2. ุงูุชุญูู ูู Row Level Security (RLS)

ุงูุตูุงุญูุงุช ุงููุถุจูุทุฉ:
- **ุงููุฑุงุกุฉ**: ุฌููุน ุงููุณุชุฎุฏููู (ุงูุฃููุงุน ุงููุดุทุฉ ููุท)
- **ุงูุฅุถุงูุฉ/ุงูุชุนุฏูู/ุงูุญุฐู**: ุงููุณุชุฎุฏููู ุงููุตุฑุญ ููู ููุท

## ๐ป ุงูุงุณุชุฎุฏุงู

### ูููุทูุฑูู

#### ุฌูุจ ุฌููุน ุฃููุงุน ุงููุดุงุฑูุน

```typescript
import { getAllProjectTypes, getProjectTypeNames } from '@/lib/projectTypesManager'

// ุฌูุจ ุฌููุน ุจูุงูุงุช ุงูุฃููุงุน
const types = await getAllProjectTypes()

// ุฌูุจ ุฃุณูุงุก ุงูุฃููุงุน ููุท (ููููุงุฆู ุงูููุณุฏูุฉ)
const typeNames = await getProjectTypeNames()
```

#### ุฅุถุงูุฉ ููุน ุฌุฏูุฏ

```typescript
import { addProjectType } from '@/lib/projectTypesManager'

const result = await addProjectType({
  name: 'New Project Type',
  code: 'NEW',
  description: 'Description of the project type',
  is_active: true
})

if (result.success) {
  console.log('Project type added:', result.data)
}
```

#### ุชุญุฏูุซ ููุน

```typescript
import { updateProjectType } from '@/lib/projectTypesManager'

const result = await updateProjectType(typeId, {
  name: 'Updated Project Type Name',
  description: 'Updated description'
})
```

#### ุญุฐู (ุชุนุทูู) ููุน

```typescript
import { deleteProjectType } from '@/lib/projectTypesManager'

const result = await deleteProjectType(typeId)
```

#### ุชุชุจุน ุงูุงุณุชุฎุฏุงู

```typescript
import { incrementProjectTypeUsage } from '@/lib/projectTypesManager'

// ูุชู ุงุณุชุฏุนุงุคูุง ุชููุงุฆูุงู ุนูุฏ ุฅูุดุงุก ูุดุฑูุน ุฌุฏูุฏ
await incrementProjectTypeUsage('Infrastructure')
```

### ูููุณุชุฎุฏููู

#### ุงููุตูู ุฅูู ุฅุฏุงุฑุฉ ุฃููุงุน ุงููุดุงุฑูุน

1. ุงูุชูู ุฅูู **Settings** โ๏ธ
2. ุงุฎุชุฑ ุชุงุจ **Project Types** ๐
3. ููููู:
   - ุนุฑุถ ุฌููุน ุงูุฃููุงุน
   - ุฅุถุงูุฉ ููุน ุฌุฏูุฏ
   - ุชุนุฏูู ููุน ููุฌูุฏ
   - ุญุฐู ููุน

#### ุฅุถุงูุฉ ููุน ูู Smart Project Creator

1. ุงูุชุญ ูููุฐุฌ ุฅูุดุงุก ูุดุฑูุน ุฌุฏูุฏ
2. ูู ุญูู **Project Type**:
   - ุงุจุฏุฃ ุจูุชุงุจุฉ ุงุณู ุงูููุน
   - ุฅุฐุง ูู ููู ููุฌูุฏุงูุ ุณุชุธูุฑ ุฎูุงุฑ "โ Add as new project type"
   - ุงุถุบุท ุนููู ูุฅุถุงูุฉ ุงูููุน ูุจุงุดุฑุฉ

## ๐ ุงูุฃูุงู

### Row Level Security (RLS)

```sql
-- ุณูุงุณุฉ ุงููุฑุงุกุฉ (ุงูุฌููุน)
CREATE POLICY "Anyone can view active project types"
  ON project_types FOR SELECT
  USING (is_active = TRUE);

-- ุณูุงุณุฉ ุงูุฅุถุงูุฉ/ุงูุชุนุฏูู/ุงูุญุฐู (ุงููุตุฑุญ ููู ููุท)
CREATE POLICY "Authenticated users can manage project types"
  ON project_types FOR ALL
  TO authenticated
  USING (TRUE);
```

### ุตูุงุญูุงุช ุงููุณุชุฎุฏููู

- **Admin & Manager**: ุงููุตูู ุงููุงูู ูุฅุฏุงุฑุฉ ุฃููุงุน ุงููุดุงุฑูุน
- **Engineer & Viewer**: ุงููุฑุงุกุฉ ููุท

## ๐ ุงูุฅุญุตุงุฆูุงุช

### ุฏุงูุฉ `get_project_type_stats()`

```sql
SELECT * FROM get_project_type_stats();
```

ุชุนุฑุถ:
- ุงุณู ููุน ุงููุดุฑูุน
- ุนุฏุฏ ุงููุดุงุฑูุน
- ุฅุฌูุงูู ูููุฉ ุงูุนููุฏ

## ๐ฏ ุฃูุถู ุงูููุงุฑุณุงุช

1. **ุงุณุชุฎุฏู ุฃููุงุฏ ูุตูุฑุฉ**: 
   - ูุซู: INF, BLD, RD, MAR
   - ุชุณูู ุงูุชุนุฑู ุงูุณุฑูุน

2. **ุฃุถู ูุตู ูุงุถุญ**:
   - ูุณุงุนุฏ ูู ููู ุฏูุฑ ุงูููุน
   - ูููุฏ ูููุณุชุฎุฏููู ุงูุฌุฏุฏ

3. **ูุง ุชุญุฐู ุงูุฃููุงุน ุงููุณุชุฎุฏูุฉ**:
   - ุงููุธุงู ูููู ุจุชุนุทูููุง ุจุฏูุงู ูู ุงูุญุฐู
   - ูุญุงูุธ ุนูู ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ

4. **ุชุชุจุน ุงูุงุณุชุฎุฏุงู**:
   - ุฑุงูุจ usage_count ููุนุฑูุฉ ุงูุฃููุงุน ุงูุฃูุซุฑ ุงุณุชุฎุฏุงูุงู
   - ูุณุงุนุฏ ูู ุงูุชุฎุทูุท ูุงูุชูุฒูุน

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงูููุน ูุง ูุธูุฑ ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ

**ุงูุญู:**
- ุชุฃูุฏ ูู ุฃู `is_active = true`
- ูู ุจุชุญุฏูุซ ุงูุตูุญุฉ
- ุชุญูู ูู ุงูุงุชุตุงู ุจู Supabase

### ุฎุทุฃ ุนูุฏ ุฅุถุงูุฉ ููุน ุฌุฏูุฏ

**ุงูุญู:**
- ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ููุน ุจููุณ ุงูุงุณู
- ุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู
- ุฑุงุฌุน RLS Policies ูู Supabase

### ุนุฏุงุฏ ุงูุงุณุชุฎุฏุงู ูุง ูุชุญุฏุซ

**ุงูุญู:**
- ุชุฃูุฏ ูู ุงุณุชุฏุนุงุก `incrementProjectTypeUsage()`
- ุชุญูู ูู ุงูู console ููุฃุฎุทุงุก
- ุชุฃูุฏ ูู ูุฌูุฏ ุงูููุน ูู ุงูุฌุฏูู

## ๐ ุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ

### ูุฎุทุท ุงูุชุทููุฑ
- [ ] ุฅุถุงูุฉ ุตูุงุญูุงุช ูุฎุตุตุฉ ููู ููุน
- [ ] ุชูุงุฑูุฑ ุชูุตูููุฉ ููู ููุน
- [ ] ุงุณุชูุฑุงุฏ/ุชุตุฏูุฑ ุงูุฃููุงุน
- [ ] ุฏูุฌ ุงูุฃููุงุน
- [ ] ุชุงุฑูุฎ ุงูุชุบููุฑุงุช (Audit Log)

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู ุฃู ูุฏูู ุงูุชุฑุงุญุงุช:
1. ุชุญูู ูู console.log ููุฃุฎุทุงุก
2. ุฑุงุฌุน Supabase logs
3. ุชุฃูุฏ ูู ุชูููุฐ SQL Schema ุจุดูู ุตุญูุญ

---

## ๐ ุงูุฎูุงุตุฉ

ุชู ุฅุถุงูุฉ ูุธุงู ุฅุฏุงุฑุฉ ุฃููุงุน ุงููุดุงุฑูุน ุจููุณ ุฌูุฏุฉ ูุธุงู ุงูุฃูุณุงู:

### โ ุงููุฒุงูุง:
- ุฅุฏุงุฑุฉ ูุงููุฉ ูู Supabase
- ูุงุฌูุฉ ูุณุชุฎุฏู ุญุฏูุซุฉ
- ุชูุงูู ูุน Smart Project Creator
- ุชุชุจุน ุงูุงุณุชุฎุฏุงู ูุงูุฅุญุตุงุฆูุงุช
- ุฃูุงู ูุชูุฏู ูุน RLS

### ๐ ุฌุงูุฒ ููุงุณุชุฎุฏุงู:
- 6 ุฃููุงุน ุงูุชุฑุงุถูุฉ
- ุฅููุงููุฉ ุฅุถุงูุฉ ุฃููุงุน ุฌุฏูุฏุฉ
- ุฅุฏุงุฑุฉ ูู ุงูุฅุนุฏุงุฏุงุช
- ุชูุงูู ูุงูู ูุน ุงููุธุงู

**ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ:** AI Assistant  
**ุงูุชุงุฑูุฎ:** 2025-10-07  
**ุงูุฅุตุฏุงุฑ:** 1.0.0
